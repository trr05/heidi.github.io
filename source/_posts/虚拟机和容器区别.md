---
title: 虚拟机&容器对比
date: 2021-01-28 10:15:25
tags:
    - 容器系列
    
---
#### 虚拟机和容器的对比图

![](/blog/images/vm.png)

###### 图左---虚拟机的原理
Hypervisor：虚拟机监控器，是一个用于创建和运行虚拟机的进程

**一台主机计算机可通过虚拟化的方式共享其资源(如内存和处理资源)来支持多台客户机虚拟机，它在这些虚拟的硬件上安装了一个新的操作系统，即Guest OS**

用户进程可以运行在这个虚拟的机器中 ，它能看到的自然也只有Guest OS的文件和目录，以及这个机器里的虚拟设备



###### 图右---容器原理

用户运行在容器里的应用进程，跟宿主机上的其他进程一样，都由宿主机操作系统统一管理，只不过这些被隔离的进程拥有额外设置过的Namespace参数，而Docker Engine在这里扮演的角色，更多是旁路式的辅助和管理工作


##### 为什么Docker项目比虚拟机更受欢迎
1. 使用虚拟化技术作为应用沙盒，就必须要由Hypervisor来负责创建虚拟机，这个虚拟机是真实存在的，并且它里面必须运行着一个完整的Guest OS才能执行用户的应用进程，这就不可避免地带来了额外的资源消耗和占用

2. 用户应用运行在虚拟机里面，它对宿主机操作系统的调用就不可避免地要经过虚拟化软件的拦截和处理，这本身就是一层性能消耗，尤其是计算资源、网络和磁盘I/O的损耗非常大

3. 相比之下，容器化后的用户应用，却依然还是一个宿主机的普通进程，这就意味着因为虚拟化而带来的性能损耗都是不存在的
此外，使用Namespace作为隔离手段的容器不需要单独的Guest OS，这就使得容器额外的资源占用几乎可以忽略不计

4. 但Docker也存在不足之处-隔离得不彻底，既然容器只是运行在宿主机上的一种特殊的进程，那么多个容器之间使用的就还是同一个宿主机的操作系统的内核；其次，在Linux内核中 ，有很多资源和对象是不能被Namesapce化的，比如时间